<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.nuonuo.mapper.orderMapper">

    <select id="getDBAllOrgList" resultType="java.util.Map">
        select id_num,code,AppKey,AppSecret,access_token,refresh_token,user_id,org_id,app_name,update_time from XXX_code_token
    </select>

    <update id="updateOrgToken" parameterType="java.util.Map">
        update XXX_code_token set access_token = #{access_token},refresh_token = #{refresh_token},update_time = GETDATE()
        where org_id = #{org_id}
    </update>

    <select id="getTokenByAppKey" parameterType="java.lang.String" resultType="java.lang.String">
        select access_token from XXX_code_token where AppKey = #{AppKey}
    </select>

    <select id="getAppKeySecretByAppKey" parameterType="java.lang.String" resultType="java.util.Map">
        select AppKey,AppSecret from XXX_code_token where org_id = #{OrgId}
    </select>

    <select id="getRedetailList" parameterType="java.lang.String" resultType="java.util.Map">
        select t4.name as storeName,t1.voucherdate,t3.name,t2.quantity,t2.taxAmount
        from re_retail t1,re_retail_b t2,AA_inventory t3,AA_DR_Store t4
        where t1.code = #{code} and t1.id = t2.idRetailDTO and t2.idInventory = t3.id and t1.idStore = t4.id
    </select>

    <update id="updateRetailKPBycode" parameterType="java.lang.String">
        update re_retail
        set memo = memo + 'Y' , priusefdeceml2 = '1'
        where code  = #{code}
    </update>

    <select id="getDistinctTaxByRetaiCode" parameterType="java.lang.String" resultType="java.util.Map">
        select t3.appKey,t3.appSecret,t3.taxnum,t3.token
        from re_retail t1,AA_distinct t2,xxx_code_token t3
        where t1.iddistinct = t2.id and t2.id = t3.iddistinct
        and t1.code = #{code}
    </select>
</mapper>